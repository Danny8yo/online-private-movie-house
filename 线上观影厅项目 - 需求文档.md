# 线上观影厅项目 - 需求文档

## 1. 文档信息

- **项目名称**: 线上观影厅 (Online Movie House)
- **文档版本**: v1.0
- **更新日期**: 2025年10月21日

---

## 2. 项目概述

### 2.1. 产品定义
本项目旨在开发一个仿照B站“放映厅”功能的线上观影平台。它是一个基于Web的、开箱即用的、开源免费的项目，核心功能是让用户可以自主上传片源，并与朋友在同步的播放环境中一同观看。

### 2.2. 项目愿景
打造一个轻量级、无广告的线上观影解决方案，让分隔两地的朋友、情侣和家人能够轻松实现“一起看电影”的愿望，重拾共同娱乐的美好时光。

### 2.3. 核心理念
- **搭建者折腾，朋友享受**: 仅需项目搭建者进行一次部署，所有使用者即可轻松加入。
- **零门槛使用**: 无需安装额外插件、无需注册登录、无需下载专用浏览器。
- **自由可控**: 用户可自主上传和管理片源，不受平台版权和片库的限制。
- **开源免费**: 项目完全免费并开源，服务于小圈子社交娱乐。

### 2.4. 本质架构
本项目本质上是一个 **聊天室 + 一个播放同步的流媒体服务**。

---

## 3. 功能需求 

### 3.1. FR1: 房间管理系统

#### 3.1.1. 单房间模式 (v1.0)
- **优先级**: P0 (必须)
- **描述**: v1.0版本仅支持单个观影房间。由于项目由用户自行在服务器上搭建，性能有限，初期版本不引入多房间的复杂性。
- **验收标准**:
    - 应用启动后，所有用户访问都将进入同一个默认的观影房间。

#### 3.1.2. 多房间支持 (后续扩展)
- **优先级**: P2 (可选)
- **描述**: 作为后续扩展功能，允许用户创建和加入不同的观影房间。

---

### 3.2. FR2: 用户管理系统

#### 3.2.1. 快速入场
- **优先级**: P0 (必须)
- **描述**: 无需设计复杂的登录验证模块。用户在进入观影厅时，仅需设置一个临时名称即可。
- **验收标准**:
    - 用户首次访问时，系统会提示用户输入一个昵称。
    - 输入昵称后，用户直接进入观影厅主界面。

#### 3.2.2. 用户列表
- **优先级**: P0 (必须)
- **描述**: 在界面上需要清晰地展示当前房间内的在线情况。
- **验收标准**:
    - 界面上显示当前房间的总人数。
    - 界面上显示所有在线用户的昵称列表。
    - 当有用户进入或离开时，人数和列表应实时更新。

---

### 3.3. FR3: 视频播放系统

#### 3.3.1. 播放同步
- **优先级**: P0 (必须)
- **描述**: 保证房间内所有用户的播放状态（播放、暂停、进度）实时同步。
- **验收标准**:
    - 房主（或有控制权的用户）进行播放、暂停、进度条拖拽等操作时，所有观看者的播放器状态能在1秒内同步。
    - 新用户加入房间时，其播放器会自动同步到当前的播放进度。

#### 3.3.2. 视频源支持
- **优先级**: P0 (必须)
- **描述**: 用户可以灵活地选择不同的视频来源。
- **验收标准**:
    - **本地上传**: 提供文件上传接口，允许用户将本地视频文件上传到服务器。
    - **服务器视频**: 允许用户播放已经存储在服务器上的视频文件。
    - **在线URL**: 支持输入外部视频的URL进行播放。

#### 3.3.3. 视频格式与处理
- **优先级**: P0 (必须)
- **描述**: 支持常见的视频格式，并通过转码保证兼容性。
- **验收标准**:
    - 支持直接播放MP4格式的视频。
    - 支持上传MKV等其他常见格式，并通过后端（如FFmpeg）自动转码为HLS或MP4格式以保证Web端兼容性。
    - 上传视频后，系统能调用视频处理工具进行转码。

#### 3.3.4. 字幕系统
- **优先级**: P1 (重要)
- **描述**: 提供外挂字幕支持，并允许用户调整字幕。
- **验收标准**:
    - 支持上传常见的字幕文件格式（如.srt, .ass）。
    - 用户可以对字幕的显示时间进行正向或负向的微调。

---

### 3.4. FR4: 互动系统

#### 3.4.1. 弹幕功能
- **优先级**: P0 (必须)
- **描述**: 提供实时弹幕功能，以增强“一起看”的沉浸感和互动体验。
- **验收标准**:
    - 用户可以发送弹幕。
    - 弹幕内容实时显示在视频画面上。
    - 弹幕的发送和显示逻辑与视频同步、聊天室功能协同工作。

#### 3.4.2. 聊天室功能
- **优先级**: P1 (重要)
- **描述**: 提供一个基础的文本聊天区域，供用户进行交流。
- **验收标准**:
    - 用户可以在聊天框内发送和接收文字消息。
    - 聊天记录仅在当前会话中保留。

---

## 4. 非功能需求 (Non-Functional Requirements)

### 4.1. NFR1: 性能
- **并发用户**: v1.0版本设计目标为支持10-20人同时在线流畅观看。
- **响应时间**: 播放同步延迟应小于1秒，弹幕和聊天消息延迟应小于500毫秒。

### 4.2. NFR2: 易用性
- **部署**: 提供清晰的部署文档，目标是让有基础技术能力的用户能在30分钟内完成部署。后续提供Docker一键部署。
- **使用**: 界面简洁直观，用户无需阅读说明即可上手使用核心功能。

### 4.3. NFR3: 兼容性
- **浏览器**: 支持主流现代浏览器（Chrome, Firefox, Safari, Edge）的最新版本。
- **平台**: 核心功能基于Web端开发，保证PC端良好体验。

### 4.4. NFR4: 可维护性
- **模块化**: 各主要功能（如播放同步、聊天、弹幕、文件上传）应封装成独立的模块，只暴露必要的接口。
- **文档**: 每个模块的负责人需要撰写开发日志和使用文档，方便团队协作。

---

## 5. 技术需求 (Technical Requirements)

### 5.1. 前端
- **框架**: Vue.js
- **播放器**: Video.js (用于处理视频播放，支持HLS/DASH流，并提供丰富的API)

### 5.2. 后端
- **框架**: Node.js + Express
- **实时通信**: Socket.IO (用于实现聊天室、播放同步、弹幕等实时双向通信)
- **视频处理**: FFmpeg (用于处理用户上传的视频，如转码为HLS或MP4格式)
- **Web服务器**: Nginx (用于高效地暴露和提供视频文件访问)
- **数据库**: v1.0版本暂不涉及数据库，用户信息和聊天记录为临时性。

---

## 6. 范围与阶段

### 6.1. 阶段一：核心功能实现 (v1.0)
- 实现单房间观影厅。
- 完成播放同步、基础聊天和弹幕功能。
- 实现视频上传、转码和播放功能。
- 完成Web端的开发。

### 6.2. 阶段二：体验优化 (v1.5)
- 支持更多视频格式的自动转码。
- 开发独立的手机端APP以优化移动观影体验。
- 完善字幕功能（如样式调整）。
- 优化播放控制逻辑。
- 提供Docker一键部署方案。

### 6.3. 阶段三：功能扩展 (v2.0)
- 实现多房间支持。
- 进行性能优化，支持更多并发用户。
- 增加社区功能（如用户系统、观影历史）。
- 开发嵌入式应用，适配电视端。

---

## 7. 验收标准 (v1.0)

- **核心功能**: 至少10个用户小团体能流畅地使用产品完成一次完整的线上观影活动。
- **稳定性**: 在测试期间，因同步失败或严重卡顿导致的会话失败比例低于5%。
- **部署**: 遵循部署文档，可以在服务器上成功运行项目。
- **功能完整性**: 本文档中标记为P0和P1的功能需求均已实现并可正常工作。